# ThreadLocal

## ThreadLocal
多个线程访问同一个共享变量时特别容易出现并发问题，特别是在多个线程需要对一个共享变量进行写入时。为了保证线程安全，一般使用者在访问共享变量时需要进行适当的同步。

同步措施一般是加锁

当创建一个变量后，每个线程对其进行访问的时候访问的是自己线程的变量，ThreadLocal就可以做这件事，但并不是为了解决这个问题而出现的。



## 底层
如果创建了一个TheadLocal变量，那么访问这个变量的每个线程都会有这个变量的一个本地副本。当多个线程操作这个变量时，实际操作的是自己本地内存里面的变量，从而避免了线程安全的问题。



## ThreadLocal不支持继承性
子线程获取不到

main线程与子线程两者是不同的线程，子线程访问时返回null



## InheritableThreadLocal

## 总结
1. 每个线程内部都会有一个名为threadLocals的成员变量，该变量的类型为HashMap。每个线程的本地变量存放在线程自己的内存变量threadLocals中，如果当前线程一直不消亡，那么这些本地变量会一直存在，所以可能会造成内存溢出。因此使用完毕后要记得调用threadLocal中的remove方法删除对应线程的threadLocals的本地变量。